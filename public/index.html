<!DOCTYPE html>
<html lang="en">

<head>
   <!-- basic -->
   <meta charset="utf-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <!-- mobile metas -->
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="viewport" content="initial-scale=1, maximum-scale=1">
   <!-- site metas -->
   <title>BestWatch</title>
   <meta name="keywords" content="">
   <meta name="description" content="">
   <meta name="author" content="">
   <!-- bootstrap css -->
   <link rel="stylesheet" href="css/bootstrap.min.css">
   <!-- style css -->
   <link rel="stylesheet" href="css/style.css">
   <!-- Responsive-->
   <link rel="stylesheet" href="css/responsive.css">
   <!-- fevicon -->
   <link rel="icon" href="images/fevicon.png" type="image/gif" />
   <!-- Scrollbar Custom CSS -->
   <link rel="stylesheet" href="css/jquery.mCustomScrollbar.min.css">
   <!-- Tweaks for older IEs-->
   <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
   <!-- owl stylesheets -->
   <link rel="stylesheet" href="css/owl.carousel.min.css">
   <link rel="stylesheet" href="css/owl.theme.default.min.css">
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css"
      media="screen">
</head>

<body>
   <!-- header section start -->
   <div class="header_section">
      <nav class="navbar navbar-expand-lg navbar-light bg-light">
         <div class="container">
            <a class="logo" href="index.html"><img style="width: 70px; height: 70px;" src="images/logo.png"></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
               aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
               <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
               <ul class="navbar-nav mr-auto">
                  <li class="nav-item"><a class="nav-link" href="/index.html">Home</a></li>
                  <li class="nav-item"><a class="nav-link" href="/products.html">Product</a></li>
                  <li class="nav-item"><a class="nav-link" href="/cart.html">Cart</a></li>
                  <li class="nav-item"><a class="nav-link" href="">Shop</a></li>
                  <li class="nav-item"><a class="nav-link" href="">Contact Us</a></li>
                  <li id="admin-menu" class="nav-item"><a class="nav-link active" href="admin.html"><strong>Admin
                           manage</strong></a></li>
               </ul>
               <form class="form-inline my-2 my-lg-0">
                  <div class="search_icon">
                     <ul>
                        <div class="dropdown" id="user-menu">
                           <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button"
                              data-toggle="dropdown" aria-expanded="false">
                              <img src="images/user-icon.png">
                           </a>
                           <div class="dropdown-menu" aria-labelledby="userDropdown" id="user-dropdown-content">
                              <!-- Nội dung sẽ thay đổi dựa trên login -->
                           </div>
                        </div>
                     </ul>
                  </div>
               </form>
            </div>
      </nav>
   </div>
   </div>
   <!-- header section end -->
   <!-- banner section start -->
   <div class="banner_section layout_padding">
      <div id="main_slider" class="carousel slide" data-ride="carousel">
         <div class="carousel-inner">
            <div class="carousel-item active">
               <div class="container">
                  <div class="row">
                     <div class="col-md-6">
                        <h1 class="banner_taital">Best <br> Design <br>of Watch</h1>
                        <p class="banner_text">It is a long established fact that a reader will bedistracted by the
                           readable content of </p>
                        <div class="btn_main">
                           <div class="contact_bt"><a href="#">Contact US</a></div>
                        </div>
                     </div>
                     <div class="col-md-6">
                        <div class="image_1"><img src="images/img-1.png"></div>
                     </div>
                  </div>
               </div>
            </div>
            <div class="carousel-item">
               <div class="container">
                  <div class="row">
                     <div class="col-md-6">
                        <h1 class="banner_taital">Best <br> Design <br>of Watch</h1>
                        <p class="banner_text">It is a long established fact that a reader will bedistracted by the
                           readable content of </p>
                        <div class="btn_main">
                           <div class="contact_bt"><a href="#">Contact US</a></div>
                        </div>
                     </div>
                     <div class="col-md-6">
                        <div class="image_1"><img src="images/img-1.png"></div>
                     </div>
                  </div>
               </div>
            </div>
            <div class="carousel-item">
               <div class="container">
                  <div class="row">
                     <div class="col-md-6">
                        <h1 class="banner_taital">Best <br> Design <br>of Watch</h1>
                        <p class="banner_text">It is a long established fact that a reader will bedistracted by the
                           readable content of </p>
                        <div class="btn_main">
                           <div class="contact_bt"><a href="#">Contact US</a></div>
                        </div>
                     </div>
                     <div class="col-md-6">
                        <div class="image_1"><img src="images/img-1.png"></div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
         <a class="carousel-control-prev" href="#main_slider" role="button" data-slide="prev">
            <i style="font-style: initial;">01</i>
         </a>
         <a class="carousel-control-next" href="#main_slider" role="button" data-slide="next">
            <i style="font-style: initial;">02</i>
         </a>
      </div>
   </div>
   <!-- banner section end -->
   <!-- about section start -->
   <div class="about_section layout_padding">
      <div class="container">
         <div class="about_section_2">
            <div class="row">
               <div class="col-md-6">
                  <div class="image_2"><img src="images/img-2.png"></div>
               </div>
               <div class="col-md-6">
                  <h1 class="about_taital">About Us</h1>
                  <p class="about_text">There are many variations of passages of Lorem Ipsum available, but the majority
                     have suffered alteration in some form, by injected humour, or randomised </p>
                  <div class="readmore_bt"><a href="#">Read More</a></div>
               </div>
            </div>
         </div>
      </div>
   </div>
   <!-- about section end -->
   <!--  design section start -->
   <div class="design_section layout_padding">
      <div id="my_slider" class="carousel slide" data-ride="carousel">
         <div class="carousel-inner">
            <div class="carousel-item active">
               <div class="container">
                  <h1 class="design_taital">Our Work Watch</h1>
                  <p class="design_text">There are many variations of passages of Lorem Ipsum available, but the
                     majority have suffered alteratio</p>
                  <div class="design_section_2">
                     <div id="products" class="row">
                        <!-- <div class="col-md-4">
                              <div class="box_main">
                                 <p class="chair_text">Watch 01</p>
                                 <div class="image_3" href="#"><img src="images/img-3.png"></div>
                                 <p class="chair_text">Price $100</p>
                                 <div class="buy_bt"><a href="#">Buy Now</a></div>
                              </div>
                           </div>
                           <div class="col-md-4">
                              <div class="box_main">
                                 <p class="chair_text">Watch 02</p>
                                 <div class="image_4" href="#"><img src="images/img-4.png"></div>
                                 <p class="chair_text">Price $100</p>
                                 <div class="buy_bt"><a href="#">Buy Now</a></div>
                              </div>
                           </div>
                           <div class="col-md-4">
                              <div class="box_main">
                                 <p class="chair_text">Watch</p>
                                 <div class="image_4" href="#"><img src="images/img-5.png"></div>
                                 <p class="chair_text">Price $100</p>
                                 <div class="buy_bt"><a href="#">Buy Now</a></div>
                              </div>
                           </div> -->
                     </div>
                  </div>
               </div>
            </div>
            <div class="carousel-item">
               <div class="container">
                  <h1 class="design_taital">Our Work Watch</h1>
                  <p class="design_text">There are many variations of passages of Lorem Ipsum available, but the
                     majority have suffered alteratio</p>
                  <div class="design_section_2">
                     <div id="products" class="row">
                        <!-- <div class="col-md-4">
                              <div class="box_main">
                                 <p class="chair_text">Chair 01</p>
                                 <div class="image_3" href="#"><img src="images/img-3.png"></div>
                                 <p class="chair_text">Price $100</p>
                                 <div class="buy_bt"><a href="#">Buy Now</a></div>
                              </div>
                           </div>
                           <div class="col-md-4">
                              <div class="box_main">
                                 <p class="chair_text">Chair 02</p>
                                 <div class="image_4" href="#"><img src="images/img-4.png"></div>
                                 <p class="chair_text">Price $100</p>
                                 <div class="buy_bt"><a href="#">Buy Now</a></div>
                              </div>
                           </div>
                           <div class="col-md-4">
                              <div class="box_main">
                                 <p class="chair_text">Table</p>
                                 <div class="image_4" href="#"><img src="images/img-5.png"></div>
                                 <p class="chair_text">Price $100</p>
                                 <div class="buy_bt"><a href="#">Buy Now</a></div>
                              </div>
                           </div> -->
                     </div>
                  </div>
               </div>
            </div>
            <div class="carousel-item">
               <div class="container">
                  <h1 class="design_taital">Our Work Watch</h1>
                  <p class="design_text">There are many variations of passages of Lorem Ipsum available, but the
                     majority have suffered alteratio</p>
                  <div class="design_section_2">
                     <div id="products" class="row">
                        <!-- <div class="col-md-4">
                              <div class="box_main">
                                 <p class="chair_text">Chair 01</p>
                                 <div class="image_3" href="#"><img src="images/img-3.png"></div>
                                 <p class="chair_text">Price $100</p>
                                 <div class="buy_bt"><a href="#">Buy Now</a></div>
                              </div>
                           </div>
                           <div class="col-md-4">
                              <div class="box_main">
                                 <p class="chair_text">Chair 02</p>
                                 <div class="image_4" href="#"><img src="images/img-4.png"></div>
                                 <p class="chair_text">Price $100</p>
                                 <div class="buy_bt"><a href="#">Buy Now</a></div>
                              </div>
                           </div>
                           <div class="col-md-4">
                              <div class="box_main">
                                 <p class="chair_text">Table</p>
                                 <div class="image_4" href="#"><img src="images/img-5.png"></div>
                                 <p class="chair_text">Price $100</p>
                                 <div class="buy_bt"><a href="#">Buy Now</a></div>
                              </div>
                           </div> -->
                     </div>
                  </div>
               </div>
            </div>
         </div>
         <!-- Nút Prev -->
         <a class="carousel-control-prev" href="javascript:void(0);" id="prev-page" role="button">
            <i class="fa fa-long-arrow-left"></i>
         </a>

         <!-- Nút Next -->
         <a class="carousel-control-next" href="javascript:void(0);" id="next-page" role="button">
            <i class="fa fa-long-arrow-right"></i>
         </a>
      </div>
      <div class="container">
         <div class="read_bt"><a href="#">Read More</a></div>
      </div>
   </div>
   <!--  design section end -->
   <!--  newsletter section start -->
   <div class="newsletter_section layout_padding">
      <div class="container">
         <div class="row">
            <div class="col-md-6">
               <div class="imgage_6"><img src="images/img-6.png"></div>
            </div>
            <div class="col-md-6">
               <h1 class="newsletter_taital">Subscribe Newsletter</h1>
               <input type="text" class="email_text" placeholder="Enter Your Email" name="Enter Your Email">
               <div class="subscribe_bt"><a href="#">Subscribe Now</a></div>
            </div>
         </div>
      </div>
   </div>
   <!--  newsletter section end -->
   <!-- contact section start -->
   <div class="contact_section layout_padding">
      <div class="container">
         <div class="contact_section_2">
            <div class="row">
               <div class="col-md-6">
                  <div class="mail_section_1">
                     <h1 class="contact_taital">Contact Us</h1>
                     <input type="text" class="mail_text" placeholder="Name" name="text">
                     <input type="text" class="mail_text" placeholder="Email" name="text">
                     <input type="text" class="mail_text" placeholder="Phone Number" name="text">
                     <textarea class="massage-bt" placeholder="Massage" rows="5" id="comment" name="Massage"></textarea>
                     <div class="send_bt"><a href="#">SEND</a></div>
                  </div>
               </div>
               <div class="col-md-6">
                  <div class="map_main">
                     <div class="map-responsive">
                        <iframe
                           src="https://www.google.com/maps/embed/v1/place?key=AIzaSyA0s1a7phLN0iaD6-UE7m4qP-z21pH0eSc&amp;q=Eiffel+Tower+Paris+France"
                           width="600" height="360" frameborder="0" style="border:0; width: 100%;"
                           allowfullscreen=""></iframe>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
   <!-- contact section end -->
   <!-- footer section start -->
   <div class="footer_section">
      <div class="container">
         <div class="footer_location_text">
            <ul>
               <li><img src="images/map-icon.png"><span class="padding_left_10"><a href="#">Loram Ipusm hosting
                        web</a></span></li>
               <li><img src="images/call-icon.png"><span class="padding_left_10"><a href="#">Call :
                        +7586656566</a></span></li>
               <li><img src="images/mail-icon.png"><span class="padding_left_10"><a href="#">demo@gmail.com</a></span>
               </li>
            </ul>
         </div>
         <div class="row">
            <div class="col-lg-3 col-sm-6">
               <h2 class="useful_text">Useful link </h2>
               <div class="footer_menu">
                  <ul>
                     <li><a href="index.html">Home</a></li>
                     <li><a href="">About</a></li>
                     <li><a href="">Our Designe</a></li>
                     <li><a href="">Contact Us</a></li>
                  </ul>
               </div>
            </div>
            <div class="col-lg-3 col-sm-6">
               <h2 class="useful_text">Repair</h2>
               <p class="lorem_text">Lorem ipsum dolor sit amet, consectetur adipiscinaliqua Loreadipiscing </p>
            </div>
            <div class="col-lg-3 col-sm-6">
               <h2 class="useful_text">Social Media</h2>
               <div id="social">
                  <a class="facebookBtn smGlobalBtn active" href="#"></a>
                  <a class="twitterBtn smGlobalBtn" href="#"></a>
                  <a class="googleplusBtn smGlobalBtn" href="#"></a>
                  <a class="linkedinBtn smGlobalBtn" href="#"></a>
               </div>
            </div>
            <div class="col-sm-6 col-lg-3">
               <h1 class="useful_text">Our Repair center</h1>
               <p class="footer_text">Lorem ipsum dolor sit amet, consectetur adipiscinaliquaLoreadipiscing </p>
            </div>
         </div>
      </div>
   </div>
   <!-- footer section end -->
   <!-- copyright section start -->
   <div class="copyright_section">
      <div class="container">
         <p class="copyright_text">2020 All Rights Reserved. Design by <a href="https://html.design">Free html
               Templates</a></p>
      </div>
   </div>
   <!-- copyright section end -->
   <!-- Javascript files-->
   <script src="js/jquery.min.js"></script>
   <script src="js/popper.min.js"></script>
   <script src="js/bootstrap.bundle.min.js"></script>
   <script src="js/jquery-3.0.0.min.js"></script>
   <script src="js/plugin.js"></script>
   <!-- sidebar -->
   <script src="js/jquery.mCustomScrollbar.concat.min.js"></script>
   <script src="js/custom.js"></script>
   <!-- javascript -->
   <script src="js/owl.carousel.js"></script>
   <script src="js/owl.carousel.min.js"></script>
   <script src="https:cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js"></script>
   <script>
      document.addEventListener('DOMContentLoaded', () => {
         const container = document.getElementById('products');
         const prevBtn = document.getElementById('prev-page');
         const nextBtn = document.getElementById('next-page');
         let currentPage = 1;
         let totalPages = 1;

         function fetchProducts(page) {
            fetch(`/api/products?page=${page}`)
               .then(res => res.json())
               .then(data => {
                  container.innerHTML = '';
                  data.products.forEach(product => {
                     container.innerHTML += `
                     <div class="col-md-4">
                       <div class="box_main">
                         <p class="chair_text">${product.name}</p>
                         <div class="image_3">
                           <img src="${product.image || 'images/default-product.png'}" alt="${product.name}">
                         </div>
                         <p class="chair_text">Price: $${product.price}</p>
                         <form action="/cart/add" method="POST" class="d-flex justify-content-center">
                           <input type="hidden" name="productId" value="${product._id}">
                           <button type="submit" class="btn btn-success" style="margin-top:10px;">BUY NOW</button>
                           </form>
                       </div>
                     </div>
                   `;
                  });
                  totalPages = data.totalPages;
                  updatePaginationButtons();
               })
               .catch(err => console.error(err));

         }



         prevBtn.addEventListener('click', () => {
            if (currentPage > 1) {
               currentPage--;
               fetchProducts(currentPage);
            }
         });

         nextBtn.addEventListener('click', () => {
            if (currentPage < totalPages) {
               currentPage++;
               fetchProducts(currentPage);
            }
         });

         fetchProducts(currentPage);
      });
   </script>
   <script>
      document.addEventListener('DOMContentLoaded', () => {
         const userDropdown = document.getElementById('user-dropdown-content');
         const adminMenu = document.getElementById('admin-menu');

         function updateUserDropdown(data) {
            userDropdown.innerHTML = ''; // Xóa nội dung cũ
            if (!data.loggedIn) {
               // Nếu chưa đăng nhập
               userDropdown.innerHTML = `
        <a class="dropdown-item" href="login.html">Login</a>
        <a class="dropdown-item" href="register.html">Register</a>
      `;
               if (adminMenu) {
                  // Ẩn menu admin nếu chưa đăng nhập
                  adminMenu.classList.add('d-none');
               }
            } else {
               // Nếu đã đăng nhập
               userDropdown.innerHTML = `
        <span class="dropdown-item-text">Hello, ${data.username}</span>
        <a class="dropdown-item" href="#">Profile</a>
        ${data.role === 'admin' ? '<a class="dropdown-item" href="index_admin.html">Admin Panel</a>' : ''}
        <a class="dropdown-item" href="/auth/logout">Logout</a>
      `;
               if (adminMenu) {
                  // Hiển thị menu admin nếu vai trò là admin
                  if (data.role === 'admin') {
                     adminMenu.classList.remove('d-none');
                  } else {
                     adminMenu.classList.add('d-none');
                  }
               }
            }
         }

         // Gửi yêu cầu tới API /auth/me để kiểm tra trạng thái đăng nhập
         fetch('/auth/me', {
            method: 'GET',
            credentials: 'include' // Đảm bảo cookie được gửi kèm
         })
            .then(res => {
               if (res.ok) return res.json();
               throw new Error('Failed to fetch /auth/me');
            })
            .then(data => updateUserDropdown(data))
            .catch(err => {
               console.error('Error fetching /auth/me:', err);
               updateUserDropdown({ loggedIn: false });
            });
      });

   </script>
</body>

</html>